<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Safalta Express | The Ultimate Student Ecosystem</title>
    <meta name="theme-color" content="#000000">
    <meta name="description" content="Premium Boys Hostel in Begusarai. Tech-enabled, study-focused.">
    
    <!-- PRELOAD HERO IMAGE FOR INSTANT VISUAL -->
    <link rel="preload" as="image" href="https://images.unsplash.com/photo-1555854877-bab0e564b8d5?q=80&w=1200">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;700;900&family=Orbitron:wght@500;700;900&family=Rajdhani:wght@500;600;700&family=Cinzel:wght@400;700&family=Share+Tech+Mono&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
    
    <!-- Tailwind & Tools -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    
    <!-- React & Babel -->
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        /* --- CORE VARIABLES --- */
        :root { 
            --neon-blue: #00f3ff; 
            --neon-purple: #bc13fe; 
            --gold: #ffd700; 
            --void: #050505; 
            --danger: #ff003c; 
            --success: #00ff66; 
            --glass-opacity: 0.7; 
            --border-rad: 1.5rem; 
        }
        
        body { 
            background-color: var(--void); 
            font-family: 'Outfit', sans-serif; 
            color: white; 
            overflow-x: hidden; 
            -webkit-tap-highlight-color: transparent; 
            perspective: 1500px; 
            cursor: none; /* Custom cursor takes over */
            margin: 0;
        }

        /* --- SKELETON LOADER (INSTANT DISPLAY) --- */
        #static-loader {
            position: fixed; inset: 0; background: #000; z-index: 50;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            font-family: 'Orbitron', sans-serif;
        }
        .loader-title { font-size: 3rem; font-weight: 900; color: #fff; text-shadow: 0 0 20px #00f3ff; animation: pulse-fast 1s infinite; }
        @keyframes pulse-fast { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }

        /* --- SCROLLBAR --- */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #000; }
        ::-webkit-scrollbar-thumb { background: var(--neon-blue); border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--neon-purple); }

        /* --- FONTS --- */
        .font-cyber { font-family: 'Orbitron', sans-serif; letter-spacing: 0.1em; }
        .font-tech { font-family: 'Rajdhani', sans-serif; }
        .font-mono-tech { font-family: 'Share Tech Mono', monospace; }

        /* --- GLASSMORPHISM & CARDS --- */
        .glass-panel {
            background: rgba(20, 20, 30, var(--glass-opacity));
            backdrop-filter: blur(20px) saturate(180%);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-top: 1px solid rgba(255, 255, 255, 0.15);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.5);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
            overflow: hidden;
        }

        .glass-panel::before {
            content: ''; position: absolute; top: 0; left: -100%; width: 50%; height: 100%;
            background: linear-gradient(to right, transparent, rgba(255,255,255,0.05), transparent);
            transform: skewX(-25deg);
            transition: 0.5s;
            pointer-events: none;
        }

        .glass-panel:hover::before { left: 150%; transition: 0.7s ease-in-out; }
        .glass-panel:hover {
            border-color: var(--neon-blue);
            box-shadow: 0 0 30px rgba(0, 243, 255, 0.2);
            transform: translateY(-5px) scale(1.01);
            z-index: 10;
        }

        /* --- GAMIFICATION ELEMENTS --- */
        .xp-bar-container {
            position: fixed; top: 0; left: 0; width: 100%; height: 4px; 
            background: rgba(255,255,255,0.1); z-index: 9999;
        }
        .xp-bar-fill {
            height: 100%; background: linear-gradient(90deg, var(--neon-blue), var(--neon-purple));
            width: 0%; transition: width 0.3s ease-out;
            box-shadow: 0 0 10px var(--neon-blue);
        }

        /* --- GLITCH TEXT --- */
        .glitch-wrapper { position: relative; display: inline-block; }
        .glitch-text { position: relative; color: white; mix-blend-mode: lighten; }
        .glitch-text:before, .glitch-text:after {
            content: attr(data-text); position: absolute; top: 0; width: 100%; height: 100%; clip: rect(0,0,0,0);
        }
        .glitch-text:before { left: -2px; text-shadow: 2px 0 var(--danger); animation: glitch-anim-1 2s infinite linear alternate-reverse; }
        .glitch-text:after { left: 2px; text-shadow: -2px 0 var(--neon-blue); animation: glitch-anim-2 3s infinite linear alternate-reverse; }
        
        @keyframes glitch-anim-1 { 
            0% { clip: rect(20px, 9999px, 15px, 0); } 
            20% { clip: rect(50px, 9999px, 60px, 0); } 
            100% { clip: rect(0px, 9999px, 0px, 0); } 
        }
        @keyframes glitch-anim-2 { 
            0% { clip: rect(10px, 9999px, 80px, 0); } 
            20% { clip: rect(80px, 9999px, 10px, 0); } 
            100% { clip: rect(0px, 9999px, 0px, 0); } 
        }

        /* --- ANIMATIONS --- */
        .animate-float { animation: float 6s ease-in-out infinite; }
        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-15px); } }
        
        .pulse-glow { animation: pulseGlow 2s infinite; }
        @keyframes pulseGlow { 
            0% { box-shadow: 0 0 0 0 rgba(0, 243, 255, 0.4); } 
            70% { box-shadow: 0 0 0 15px rgba(0, 243, 255, 0); } 
            100% { box-shadow: 0 0 0 0 rgba(0, 243, 255, 0); } 
        }

        .bg-scanline {
            background: linear-gradient(to bottom, rgba(255,255,255,0), rgba(255,255,255,0) 50%, rgba(0,0,0,0.2) 50%, rgba(0,0,0,0.2));
            background-size: 100% 4px;
            pointer-events: none;
        }

        /* --- CURSOR --- */
        .cursor-dot {
            width: 8px; height: 8px; background: var(--neon-blue); border-radius: 50%;
            position: fixed; pointer-events: none; z-index: 10000;
            transform: translate(-50%, -50%); transition: width 0.2s, height 0.2s;
            box-shadow: 0 0 15px var(--neon-blue);
        }
        .cursor-outline {
            width: 40px; height: 40px; border: 1px solid rgba(0, 243, 255, 0.5);
            border-radius: 50%; position: fixed; pointer-events: none; z-index: 10000;
            transform: translate(-50%, -50%); transition: all 0.1s ease-out;
        }
        body:hover .cursor-outline { transform: translate(-50%, -50%) scale(1); }
        body:active .cursor-outline { transform: translate(-50%, -50%) scale(0.8); background: rgba(0,243,255,0.1); }

        /* --- SIDEBAR --- */
        .sidebar {
            position: fixed; top: 0; left: 0; width: 320px; height: 100%;
            background: rgba(5, 5, 5, 0.95);
            backdrop-filter: blur(20px);
            border-right: 1px solid rgba(0, 243, 255, 0.2);
            transform: translateX(-100%);
            transition: transform 0.4s cubic-bezier(0.68, -0.55, 0.27, 1.55);
            z-index: 5000;
            box-shadow: 50px 0 100px rgba(0, 0, 0, 0.8);
        }
        .sidebar.open { transform: translateX(0); }

        /* --- FLOATING WA --- */
        .floating-wa {
            position: fixed; bottom: 30px; right: 20px; z-index: 9000;
            background: #25D366; color: white; border-radius: 50%; width: 60px; height: 60px;
            display: flex; align-items: center; justify-content: center;
            box-shadow: 0 4px 20px rgba(37, 211, 102, 0.5);
            transition: all 0.3s; animation: pulseGlow 2s infinite;
        }
        .floating-wa:hover { transform: scale(1.1) rotate(10deg); }
        
        .god-btn {
             position: fixed; bottom: 30px; left: 20px; z-index: 9000;
             width: 50px; height: 50px; border-radius: 50%;
             background: rgba(0,0,0,0.8); border: 2px solid var(--neon-blue);
             color: var(--neon-blue); display: flex; align-items: center; justify-content: center;
             cursor: pointer; transition: all 0.3s;
        }
        .god-btn:hover { transform: rotate(180deg); background: var(--neon-blue); color: black; }

        /* --- TOAST --- */
        .toast-container { position: fixed; top: 100px; right: 20px; z-index: 9999; display: flex; flex-col; gap: 10px; pointer-events: none; }
        .toast {
            background: rgba(0,0,0,0.9); border: 1px solid var(--neon-blue);
            color: white; padding: 12px 24px; border-radius: 8px;
            display: flex; align-items: center; gap: 10px;
            animation: slideIn 0.3s cubic-bezier(0.68, -0.55, 0.27, 1.55);
            box-shadow: 0 0 20px rgba(0, 243, 255, 0.2);
        }
        @keyframes slideIn { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
    </style>
    
    <script type="importmap">
        {
            "imports": {
                "firebase/app": "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js",
                "firebase/auth": "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js",
                "firebase/firestore": "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js"
            }
        }
    </script>
</head>
<body>
    
    <!-- React Root with INSTANT FALLBACK CONTENT -->
    <div id="root">
        <!-- This displays INSTANTLY while React/Babel loads, preventing white screen -->
        <div id="static-loader">
            <h1 class="loader-title">SAFALTA</h1>
            <p style="color: #00f3ff; font-family: monospace; letter-spacing: 2px; margin-top: 10px;">INITIALIZING SYSTEM...</p>
        </div>
    </div>

    <script type="text/babel" data-type="module">
        import { initializeApp } from "firebase/app";
        import { getAuth, signInWithPopup, GoogleAuthProvider, signOut, onAuthStateChanged } from "firebase/auth";
        import { getFirestore, collection, addDoc, query, orderBy, limit, onSnapshot, serverTimestamp, doc, updateDoc, deleteDoc, getDocs, where } from "firebase/firestore";

        // --- FIREBASE CONFIG ---
        const firebaseConfig = {
            apiKey: "AIzaSyBbwul_dbciJX3SQIVFQqXktmCsCghJRHU",
            authDomain: "safalta-express-boys-hostel.firebaseapp.com",
            projectId: "safalta-express-boys-hostel",
            storageBucket: "safalta-express-boys-hostel.firebasestorage.app",
            messagingSenderId: "943963131070",
            appId: "1:943963131070:web:48db2233c27d7ae15562ef"
        };

        // Initialize Firebase
        let app, auth, db;
        try {
            app = initializeApp(firebaseConfig);
            auth = getAuth(app);
            db = getFirestore(app);
        } catch (e) { console.error("Firebase Init Error", e); }
        const googleProvider = new GoogleAuthProvider();

        const { useState, useEffect, useRef } = React;
        const { 
            Phone, MapPin, Menu, X, CheckCircle, Send, Coffee, BookOpen, Library, GraduationCap,
            User, Star, Factory, Building2, LogIn, LogOut, Brain, Sparkles, MessageSquare, Settings,
            Headphones, Play, Instagram, Calendar, Users, PenTool, Lock, Flame, Zap, Trophy,
            Activity, Power, Volume2, VolumeX, Code, Mail, Loader2
        } = lucide;

        // --- GEMINI API HELPER ---
        const callGemini = async (prompt) => {
            const apiKey = ""; // Provided by execution environment
            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
                });
                const data = await response.json();
                return data.candidates?.[0]?.content?.parts?.[0]?.text || "System Overload. Try again.";
            } catch (e) { console.error(e); return "Neural Link Failed."; }
        };

        // --- CONSTANTS ---
        const IMG = {
            hero: "https://images.unsplash.com/photo-1555854877-bab0e564b8d5?q=80&w=1200",
            poha: "https://images.unsplash.com/photo-1626082927389-6cd097cdc6ec?q=80&w=800",
            paratha: "https://images.unsplash.com/photo-1626074353765-517a681e40be?q=80&w=800",
            puri: "https://images.unsplash.com/photo-1601050690597-df0568f70950?q=80&w=800",
            chicken: "https://images.unsplash.com/photo-1603894584373-5ac82b2ae398?q=80&w=800",
            paneer: "https://images.unsplash.com/photo-1631452180519-c014fe946bc7?q=80&w=800",
            dal: "https://images.unsplash.com/photo-1546833999-b9f581a1996d?q=80&w=800",
            kadhi: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcR07k3e0bX3T5h5e6Z7e8a9b0c1d2e3f4g5h6i7&s",
            khichri: "https://images.unsplash.com/photo-1599487488170-9a1241960161?q=80&w=800",
            roti: "https://images.unsplash.com/photo-1626074353765-517a681e40be?q=80&w=800",
            kheer: "https://images.unsplash.com/photo-1616429377488-82dbb3e5102f?q=80&w=800",
            room1: "https://images.unsplash.com/photo-1555854877-bab0e564b8d5?q=80&w=800",
            room2: "https://images.unsplash.com/photo-1595526114035-0d45ed16cfbf?q=80&w=800",
            room3: "https://images.unsplash.com/photo-1628151016140-62281a7428f7?q=80&w=800",
            thali: "https://images.unsplash.com/photo-1546833999-b9f581a1996d?q=80&w=800"
        };

        const MENU = {
            Monday: { b: "Poha, Achar", b_img: IMG.poha, l: "Chicken/Paneer", l_img: IMG.chicken, d: "Roti-Sabji", d_img: IMG.roti },
            Tuesday: { b: "Roti-Sabji", b_img: IMG.roti, l: "Dal-Sabji", l_img: IMG.dal, d: "Puri-Kheer", d_img: IMG.kheer },
            Wednesday: { b: "Aloo Paratha", b_img: IMG.paratha, l: "Dal-Sabji", l_img: IMG.dal, d: "Roti-Sabji", d_img: IMG.roti },
            Thursday: { b: "Puri-Rajma", b_img: IMG.puri, l: "Dal-Bhujiya", l_img: IMG.dal, d: "Roti-Mix Veg", d_img: IMG.paneer },
            Friday: { b: "Roti-Sabji", b_img: IMG.roti, l: "Egg/Paneer", l_img: IMG.chicken, d: "Roti-Sabji", d_img: IMG.roti },
            Saturday: { b: "Roti-Sabji", b_img: IMG.roti, l: "Khichri-Chokha", l_img: IMG.khichri, d: "Puri-Sewai", d_img: IMG.puri },
            Sunday: { b: "Sattu Paratha", b_img: IMG.paratha, l: "Kadhi-Chawal", l_img: IMG.kadhi, d: "Roti-Bhujiya", d_img: IMG.roti },
        };

        const SOUNDS = {
            click: new Audio("https://assets.mixkit.co/sfx/preview/mixkit-modern-technology-select-3124.mp3"),
            hover: new Audio("https://assets.mixkit.co/sfx/preview/mixkit-sci-fi-interface-robot-click-901.mp3"),
            success: new Audio("https://assets.mixkit.co/sfx/preview/mixkit-arcade-game-jump-coin-216.mp3"),
            intro: new Audio("https://assets.mixkit.co/sfx/preview/mixkit-futuristic-robotic-glitch-3047.mp3")
        };
        // Lower volumes
        Object.values(SOUNDS).forEach(s => s.volume = 0.2);

        // --- COMPONENTS ---

        const Toast = ({ message, type, remove }) => {
            useEffect(() => {
                const timer = setTimeout(() => remove(), 3000);
                return () => clearTimeout(timer);
            }, []);
            
            const colors = {
                success: 'border-green-500 text-green-400',
                info: 'border-blue-500 text-blue-400',
                xp: 'border-purple-500 text-purple-400'
            };

            return (
                <div className={`toast ${colors[type]}`}>
                    {type === 'xp' && <Sparkles size={16} className="animate-spin" />}
                    {type === 'success' && <CheckCircle size={16} />}
                    {type === 'info' && <Activity size={16} />}
                    <span className="font-bold text-sm tracking-wide">{message}</span>
                </div>
            );
        };

        // --- AI APP COMPONENTS ---

        const OrbitPlanner = ({ close, addXp }) => {
            const [subjects, setSubjects] = useState('');
            const [hours, setHours] = useState('');
            const [schedule, setSchedule] = useState('');
            const [loading, setLoading] = useState(false);

            const handleGenerate = async () => {
                if(!subjects || !hours) return;
                setLoading(true);
                const prompt = `Create a realistic and strict study schedule for a student who wants to study these subjects: ${subjects} for a total of ${hours} hours. Use emojis, Keep it short and actionable. Format as a list.`;
                const result = await callGemini(prompt);
                setSchedule(result);
                setLoading(false);
                addXp(50, "Generated Schedule");
            };

            return (
                <div className="fixed inset-0 z-[6000] bg-black/90 backdrop-blur-xl flex items-center justify-center p-4">
                    <div className="max-w-lg w-full glass-panel p-8 rounded-3xl border border-blue-500/30 relative">
                        <button onClick={close} className="absolute top-4 right-4 text-gray-500 hover:text-white"><X/></button>
                        <h2 className="font-cyber text-2xl text-blue-400 mb-2 flex items-center gap-2"><Calendar/> ORBIT PLANNER AI</h2>
                        <p className="text-gray-400 text-sm mb-6">Generate a lethal study routine using Gemini AI.</p>
                        
                        {!schedule ? (
                            <div className="space-y-4">
                                <input 
                                    type="text" 
                                    placeholder="Subjects (e.g., Physics, Math)" 
                                    className="w-full bg-black/50 border border-white/10 rounded-xl p-4 text-white placeholder:text-gray-600 focus:border-blue-500 outline-none"
                                    value={subjects}
                                    onChange={(e)=>setSubjects(e.target.value)}
                                />
                                <input 
                                    type="number" 
                                    placeholder="Total Hours (e.g., 6)" 
                                    className="w-full bg-black/50 border border-white/10 rounded-xl p-4 text-white placeholder:text-gray-600 focus:border-blue-500 outline-none"
                                    value={hours}
                                    onChange={(e)=>setHours(e.target.value)}
                                />
                                <button 
                                    onClick={handleGenerate} 
                                    disabled={loading}
                                    className="w-full bg-blue-600 hover:bg-blue-500 py-4 rounded-xl font-black flex items-center justify-center gap-2 transition"
                                >
                                    {loading ? <Loader2 className="animate-spin"/> : <Sparkles/>} GENERATE ROUTINE âœ¨
                                </button>
                            </div>
                        ) : (
                            <div className="animate-float">
                                <div className="bg-black/40 rounded-xl p-6 mb-6 max-h-[300px] overflow-y-auto border border-white/10 font-mono text-sm leading-relaxed whitespace-pre-line">
                                    {schedule}
                                </div>
                                <button 
                                    onClick={()=>setSchedule('')} 
                                    className="w-full bg-white/10 hover:bg-white/20 py-3 rounded-xl font-bold"
                                >
                                    Create New
                                </button>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        const MistakeVault = ({ close, addXp }) => {
            const [concept, setConcept] = useState('');
            const [explanation, setExplanation] = useState('');
            const [loading, setLoading] = useState(false);

            const handleExplain = async () => {
                if(!concept) return;
                setLoading(true);
                const prompt = `Explain the concept of "${concept}" simply for a high school student. Use a real-world analogy. Keep it under 100 words.`;
                const result = await callGemini(prompt);
                setExplanation(result);
                setLoading(false);
                addXp(40, "Cleared Concept");
            };

            return (
                <div className="fixed inset-0 z-[6000] bg-black/90 backdrop-blur-xl flex items-center justify-center p-4">
                    <div className="max-w-lg w-full glass-panel p-8 rounded-3xl border border-purple-500/30 relative">
                        <button onClick={close} className="absolute top-4 right-4 text-gray-500 hover:text-white"><X/></button>
                        <h2 className="font-cyber text-2xl text-purple-400 mb-2 flex items-center gap-2"><Brain/> CONCEPT VAULT AI</h2>
                        <p className="text-gray-400 text-sm mb-6">Stuck? Let AI simplify complex topics instantly.</p>
                        
                        <div className="space-y-4">
                            <div className="flex gap-2">
                                <input 
                                    type="text" 
                                    placeholder="Enter topic (e.g., Thermodynamics)" 
                                    className="flex-1 bg-black/50 border border-white/10 rounded-xl p-4 text-white placeholder:text-gray-600 focus:border-purple-500 outline-none"
                                    value={concept}
                                    onChange={(e)=>setConcept(e.target.value)}
                                    onKeyDown={(e) => e.key === 'Enter' && handleExplain()}
                                />
                                <button 
                                    onClick={handleExplain} 
                                    disabled={loading}
                                    className="bg-purple-600 hover:bg-purple-500 px-6 rounded-xl font-black flex items-center justify-center transition"
                                >
                                    {loading ? <Loader2 className="animate-spin"/> : <Send/>}
                                </button>
                            </div>
                            
                            {explanation && (
                                <div className="bg-black/40 rounded-xl p-6 border border-purple-500/20 animate-[fadeIn_0.5s]">
                                    <h4 className="text-xs text-purple-400 font-bold mb-2 uppercase tracking-widest">AI Explanation</h4>
                                    <p className="text-sm leading-relaxed text-gray-200">{explanation}</p>
                                </div>
                            )}
                        </div>
                    </div>
                </div>
            );
        };

        const ParticleCanvas = () => {
            const canvasRef = useRef(null);
            
            useEffect(() => {
                const cvs = canvasRef.current;
                const ctx = cvs.getContext('2d');
                let w = window.innerWidth;
                let h = window.innerHeight;
                cvs.width = w; cvs.height = h;

                let particles = [];
                const pCount = 50; // Optimized count

                class Particle {
                    constructor() {
                        this.x = Math.random() * w;
                        this.y = Math.random() * h;
                        this.vx = (Math.random() - 0.5) * 0.5;
                        this.vy = (Math.random() - 0.5) * 0.5;
                        this.size = Math.random() * 2;
                        this.color = Math.random() > 0.5 ? '#00f3ff' : '#bc13fe';
                    }
                    update() {
                        this.x += this.vx; this.y += this.vy;
                        if(this.x < 0 || this.x > w) this.vx *= -1;
                        if(this.y < 0 || this.y > h) this.vy *= -1;
                    }
                    draw() {
                        ctx.fillStyle = this.color;
                        ctx.beginPath();
                        ctx.arc(this.x, this.y, this.size, 0, Math.PI*2);
                        ctx.fill();
                    }
                }

                for(let i=0; i<pCount; i++) particles.push(new Particle());

                const animate = () => {
                    ctx.clearRect(0,0,w,h);
                    particles.forEach(p => { p.update(); p.draw(); });
                    // Draw connections
                    ctx.strokeStyle = 'rgba(255,255,255,0.03)';
                    ctx.lineWidth = 1;
                    for(let i=0; i<pCount; i++){
                        for(let j=i; j<pCount; j++){
                            const dx = particles[i].x - particles[j].x;
                            const dy = particles[i].y - particles[j].y;
                            const dist = Math.sqrt(dx*dx + dy*dy);
                            if(dist < 100) {
                                ctx.beginPath(); ctx.moveTo(particles[i].x, particles[i].y);
                                ctx.lineTo(particles[j].x, particles[j].y); ctx.stroke();
                            }
                        }
                    }
                    requestAnimationFrame(animate);
                }
                animate();

                const handleResize = () => { w=window.innerWidth; h=window.innerHeight; cvs.width=w; cvs.height=h; };
                window.addEventListener('resize', handleResize);
                return () => window.removeEventListener('resize', handleResize);
            }, []);

            return <canvas ref={canvasRef} className="fixed inset-0 z-0 pointer-events-none opacity-60" />;
        };

        const GodModePanel = ({ config, setConfig, applyConfig }) => {
            const [open, setOpen] = useState(false);
            const themes = [
                { id: 'cyber', n: 'Cyberpunk', c: '#00f3ff' },
                { id: 'royal', n: 'Royal Gold', c: '#ffd700' },
                { id: 'matrix', n: 'The Matrix', c: '#00ff00' },
                { id: 'sith', n: 'Crimson Sith', c: '#ff0000' },
            ];

            return (
                <>
                    <button onClick={() => setOpen(!open)} className="god-btn">
                        <Settings size={24} className={open ? "animate-spin" : ""} />
                    </button>
                    {open && (
                        <div className="fixed bottom-24 left-5 w-80 glass-panel p-6 rounded-2xl z-50 animate-float">
                            <div className="flex justify-between items-center mb-4 border-b border-white/10 pb-2">
                                <h3 className="font-cyber text-lg text-blue-400 flex items-center gap-2">
                                    <Code size={18}/> SYSTEM CONFIG
                                </h3>
                                <button onClick={() => setOpen(false)}><X size={18}/></button>
                            </div>
                            
                            <div className="space-y-4">
                                <div>
                                    <p className="text-[10px] uppercase text-gray-500 mb-2 font-bold tracking-widest">Visual Theme</p>
                                    <div className="flex gap-2 justify-between">
                                        {themes.map(t => (
                                            <button 
                                                key={t.id} 
                                                onClick={() => setConfig({...config, theme: t.id})}
                                                className={`w-8 h-8 rounded-full border-2 transition-transform hover:scale-125 ${config.theme === t.id ? 'border-white scale-110 shadow-[0_0_10px_white]' : 'border-transparent'}`}
                                                style={{background: t.c}}
                                            />
                                        ))}
                                    </div>
                                </div>
                                
                                <div>
                                    <p className="text-[10px] uppercase text-gray-500 mb-2 font-bold tracking-widest">Audio</p>
                                    <button 
                                        onClick={() => setConfig({...config, sound: !config.sound})}
                                        className={`w-full py-2 rounded-lg border text-xs font-bold flex items-center justify-center gap-2 ${config.sound ? 'bg-blue-500/20 border-blue-500 text-blue-400' : 'bg-white/5 border-white/10 text-gray-500'}`}
                                    >
                                        {config.sound ? <Volume2 size={14}/> : <VolumeX size={14}/>} {config.sound ? 'SOUND FX ON' : 'SOUND FX OFF'}
                                    </button>
                                </div>

                                <button onClick={() => {applyConfig(); setOpen(false)}} className="w-full bg-gradient-to-r from-blue-600 to-purple-600 py-3 rounded-xl font-black text-white flex items-center justify-center gap-2 hover:scale-105 transition shadow-lg mt-2">
                                    <Power size={16} /> REBOOT SYSTEM
                                </button>
                            </div>
                        </div>
                    )}
                </>
            );
        };

        const MainApp = () => {
            const [user, setUser] = useState(null);
            const [sidebarOpen, setSidebarOpen] = useState(false);
            const [activeApp, setActiveApp] = useState(null);
            const [xp, setXp] = useState(0);
            const [level, setLevel] = useState(1);
            const [toasts, setToasts] = useState([]);
            const [config, setConfig] = useState({ theme: 'cyber', sound: true });
            
            // Gamification Logic
            const addToast = (msg, type='info') => {
                const id = Date.now();
                setToasts(prev => [...prev, {id, msg, type}]);
                if(config.sound) {
                    if(type === 'xp') SOUNDS.success.play().catch(()=>{});
                    else SOUNDS.hover.play().catch(()=>{});
                }
            };
            const removeToast = (id) => setToasts(prev => prev.filter(t => t.id !== id));

            const addXp = (amount, reason) => {
                setXp(prev => {
                    const newXp = prev + amount;
                    if(newXp >= level * 1000) {
                        setLevel(l => l + 1);
                        addToast(`LEVEL UP! You are now Level ${level + 1}`, 'success');
                        return newXp - (level * 1000);
                    }
                    return newXp;
                });
                if(reason) addToast(`+${amount} XP: ${reason}`, 'xp');
            };

            const playSound = (type) => { if(config.sound) SOUNDS[type].play().catch(()=>{}); };

            useEffect(() => {
                onAuthStateChanged(auth, setUser);
                
                // Scroll Handler for XP
                const handleScroll = () => {
                    const scrollPercent = (window.scrollY / (document.body.scrollHeight - window.innerHeight)) * 100;
                    if(Math.random() > 0.99) addXp(5); // Random scrolling XP
                };
                window.addEventListener('scroll', handleScroll);
                
                // Initialize Theme
                const root = document.documentElement;
                const themes = { 
                    cyber: { b: '#00f3ff', p: '#bc13fe', g: '#ffd700', d: '#ff003c' }, 
                    royal: { b: '#ffd700', p: '#d4af37', g: '#ffffff', d: '#800000' }, 
                    matrix: { b: '#00ff00', p: '#008f11', g: '#aaff00', d: '#003300' }, 
                    sith: { b: '#ff0000', p: '#990000', g: '#550000', d: '#ff4444' } 
                };
                const t = themes[config.theme];
                root.style.setProperty('--neon-blue', t.b);
                root.style.setProperty('--neon-purple', t.p);
                root.style.setProperty('--gold', t.g);
                root.style.setProperty('--danger', t.d);

                // Intro Sound (Reduced Delay for instant feel)
                setTimeout(() => playSound('intro'), 100);

                return () => window.removeEventListener('scroll', handleScroll);
            }, [config]);

            const login = async () => {
                try {
                    await signInWithPopup(auth, googleProvider);
                    addXp(500, "First Login");
                    playSound('success');
                } catch (e) { console.error(e); }
            };

            // Calculate progress bar width
            const progressWidth = Math.min((xp / (level * 1000)) * 100, 100);

            return (
                <div className="min-h-screen text-white selection:bg-neon-blue selection:text-black">
                    {/* XP Bar */}
                    <div className="xp-bar-container">
                        <div className="xp-bar-fill" style={{width: `${progressWidth}%`}}></div>
                    </div>

                    {/* Cursor */}
                    <div id="cursor-dot" className="cursor-dot"></div>
                    <div id="cursor-outline" className="cursor-outline"></div>

                    {/* Backgrounds */}
                    <ParticleCanvas />
                    <div className="fixed inset-0 bg-scanline z-[1] pointer-events-none"></div>

                    {/* Toast Container */}
                    <div className="toast-container">
                        {toasts.map(t => <Toast key={t.id} message={t.msg} type={t.type} remove={() => removeToast(t.id)} />)}
                    </div>

                    {/* Sidebar */}
                    <div className={`sidebar ${sidebarOpen ? 'open' : ''} flex flex-col p-6`}>
                        <div className="flex justify-between items-center mb-10">
                            <h2 className="font-cyber text-xl text-blue-400 tracking-widest glitch-text" data-text="HOSTEL OS">HOSTEL OS</h2>
                            <button onClick={() => {setSidebarOpen(false); playSound('click')}} className="hover:text-red-500 transition"><X size={24}/></button>
                        </div>
                        <div className="space-y-4 overflow-y-auto flex-1">
                            <div className="text-[10px] font-bold text-gray-500 uppercase tracking-widest mb-2">My Apps</div>
                            {[
                                {n:"Concept Vault âœ¨", i:Brain, id:"mistake", c:"text-purple-400", xp: 50},
                                {n:"Orbit Planner âœ¨", i:Calendar, id:"planner", c:"text-blue-400", xp: 20},
                                {n:"Sonic Core", i:Headphones, id:"music", c:"text-pink-400", xp: 10},
                                {n:"Group Chat", i:MessageSquare, id:"chat", c:"text-green-400", xp: 5}
                            ].map((app) => (
                                <button 
                                    key={app.id} 
                                    onClick={() => {
                                        if(!user) return addToast("Login Required", "info");
                                        setSidebarOpen(false); 
                                        setActiveApp(app.id); 
                                        addXp(app.xp, "Opened App");
                                        playSound('click');
                                    }} 
                                    className="flex items-center gap-4 text-gray-300 hover:text-white hover:bg-white/10 p-3 rounded-xl w-full transition border border-transparent hover:border-white/10 group relative overflow-hidden"
                                >
                                    <div className={`absolute inset-0 bg-gradient-to-r from-${app.c.split('-')[1]}/20 to-transparent opacity-0 group-hover:opacity-100 transition duration-500`}></div>
                                    <app.i size={18} className={app.c + " group-hover:scale-110 transition relative z-10"} />
                                    <span className="font-bold text-sm tracking-wide relative z-10">{app.n}</span>
                                    {!user && <Lock size={12} className="ml-auto text-gray-600" />}
                                </button>
                            ))}
                        </div>
                        {user ? (
                            <button onClick={() => signOut(auth)} className="mt-4 flex items-center gap-2 text-red-500 p-4 hover:bg-red-500/10 rounded-xl justify-center font-bold border border-red-500/20">
                                <LogOut size={18} /> LOGOUT
                            </button>
                        ) : (
                            <button onClick={login} className="mt-4 bg-white text-black p-4 rounded-xl font-black uppercase hover:scale-105 transition">
                                Login to Sync
                            </button>
                        )}
                    </div>

                    {/* Navbar */}
                    <nav className="fixed top-0 w-full z-40 glass-panel px-4 py-3 flex justify-between items-center">
                        <div className="flex items-center gap-4">
                            <button onClick={() => {setSidebarOpen(true); playSound('click')}} className="p-2 hover:bg-white/10 rounded-full transition"><Menu size={24} /></button>
                            <div className="flex items-center gap-3" onClick={() => {window.scrollTo(0,0); addXp(10, "Home Refresh")}}>
                                <div className="bg-gradient-to-r from-blue-600 to-purple-600 p-2 rounded-lg shadow-[0_0_15px_rgba(37,99,235,0.5)]">
                                    <GraduationCap className="text-white" size={20} />
                                </div>
                                <div>
                                    <h1 className="font-cyber text-sm md:text-lg font-black leading-none tracking-wide text-transparent bg-clip-text bg-gradient-to-r from-white to-gray-400">SAFALTA</h1>
                                    <div className="flex items-center gap-2">
                                        <p className="text-[8px] tracking-[0.2em] text-blue-400 font-bold">BOYS HOSTEL</p>
                                        <div className="px-1.5 py-0.5 rounded bg-blue-500/20 border border-blue-500/50 text-[8px] text-blue-300 font-bold">LVL {level}</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div className="flex gap-3 items-center">
                            <a href="https://www.instagram.com/safalta_express_boys_hostel?igsh=MXZyZGdvOXFldnUxNA==" target="_blank" className="bg-gradient-to-tr from-yellow-400 via-red-500 to-purple-500 p-2 rounded-full text-white shadow-lg animate-pulse hover:scale-110 transition">
                                <Instagram size={16} />
                            </a>
                            {!user ? (
                                <button onClick={login} className="hidden md:block bg-white text-black px-4 py-1.5 rounded-lg text-xs font-black uppercase hover:bg-gray-200 transition shadow-[0_0_15px_rgba(255,255,255,0.4)]">
                                    LOGIN
                                </button>
                            ) : (
                                <img src={user.photoURL} className="w-8 h-8 rounded-full border-2 border-green-500" title={`Level ${level} Student`} />
                            )}
                        </div>
                    </nav>

                    {/* HERO SECTION */}
                    <section className="h-screen flex flex-col justify-center items-center text-center relative overflow-hidden">
                        <div className="absolute inset-0 bg-black">
                            <img src={IMG.hero} className="absolute inset-0 w-full h-full object-cover opacity-30 animate-pulse scale-105 transition-transform duration-[20s]" style={{animation: 'zoomIn 20s infinite alternate'}} />
                            <div className="absolute inset-0 bg-gradient-to-t from-[var(--void)] via-black/60 to-transparent"></div>
                        </div>
                        
                        <div className="relative z-10 px-6 max-w-5xl">
                            <div className="inline-block mb-8 px-4 py-1.5 rounded-full glass-panel border border-blue-500/30 text-blue-400 text-[10px] font-black tracking-[0.3em] uppercase animate-float">
                                <span className="text-white">ðŸš€ Ritesh Sir</span> Presents
                            </div>
                            
                            <h1 className="font-cyber text-5xl md:text-8xl mb-4 text-white leading-tight glitch-wrapper">
                                <span className="glitch-text block" data-text="SAFALTA">SAFALTA</span>
                                <span className="text-4xl md:text-6xl text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-purple-500 block mt-2 font-black">EXPRESS ðŸš‚</span>
                            </h1>

                            <p className="text-lg text-gray-300 mb-12 font-light max-w-2xl mx-auto leading-relaxed border-l-2 border-blue-500 pl-4 text-left md:text-center md:border-l-0 md:pl-0">
                                The ultimate ecosystem for serious aspirants in Begusarai. 
                                <span className="text-blue-400 font-bold block mt-2">Eat Better. Sleep Better. Study Harder.</span>
                            </p>

                            <div className="flex flex-col sm:flex-row gap-6 justify-center items-center">
                                <button 
                                    onClick={() => {
                                        document.getElementById('booking').scrollIntoView({behavior:'smooth'}); 
                                        addXp(20, "Initiated Booking");
                                        playSound('click');
                                    }} 
                                    className="group relative px-8 py-4 bg-blue-600 rounded-xl font-black text-white shadow-[0_0_30px_rgba(37,99,235,0.5)] overflow-hidden transition-transform hover:scale-105"
                                >
                                    <div className="absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000"></div>
                                    <span className="relative flex items-center gap-2">BOOK SEAT <Zap size={18} className="fill-white"/></span>
                                </button>
                                
                                <a href="tel:9122802016" onClick={() => addXp(5, "Called Office")} className="glass-panel px-8 py-4 rounded-xl font-bold text-white hover:bg-white/10 transition flex items-center gap-2 border border-white/20 hover:border-white">
                                    <Phone size={18} /> Call Office
                                </a>
                            </div>
                        </div>
                    </section>

                    {/* LEGACY GRID */}
                    <section className="py-20 px-4 bg-[#050505] relative">
                        <div className="max-w-7xl mx-auto">
                            <h2 className="font-cyber text-3xl text-center mb-16 text-white tracking-widest flex items-center justify-center gap-3">
                                <MapPin className="text-red-500 animate-bounce" /> LOCATION INTEL
                            </h2>
                            <div className="grid grid-cols-2 md:grid-cols-5 gap-4">
                                {[
                                    {n:"GD College", d:"50m Campus", i:GraduationCap}, 
                                    {n:"Kaushal Comm.", d:"Coaching Hub", i:BookOpen}, 
                                    {n:"Trinity", d:"Classes", i:Library}, 
                                    {n:"Industrial", d:"Area", i:Factory}, 
                                    {n:"Readers Lib", d:"24/7 Zone", i:Building2}
                                ].map((s,i) => (
                                    <div key={i} className="glass-panel p-6 rounded-2xl text-center group hover:bg-blue-900/10 cursor-pointer transition-all duration-300" onMouseEnter={()=>playSound('hover')}>
                                        <div className="bg-gradient-to-br from-gray-800 to-black w-14 h-14 rounded-full flex items-center justify-center mx-auto mb-4 text-blue-400 group-hover:text-white group-hover:scale-110 transition border border-white/10 group-hover:border-blue-500 shadow-lg">
                                            <s.i size={24} />
                                        </div>
                                        <h4 className="font-bold text-sm text-gray-200 group-hover:text-blue-400">{s.n}</h4>
                                        <p className="text-[10px] text-gray-500 mt-1 uppercase tracking-wider">{s.d}</p>
                                    </div>
                                ))}
                            </div>
                        </div>
                    </section>

                    {/* FOOD MENU */}
                    <section id="menu" className="py-24 px-4 bg-black relative">
                        <div className="absolute top-0 right-0 w-64 h-64 bg-yellow-500/10 rounded-full blur-[100px] pointer-events-none"></div>
                        <div className="max-w-6xl mx-auto relative z-10">
                            <div className="text-center mb-12">
                                <span className="text-yellow-500 text-xs font-black tracking-[0.3em] uppercase mb-2 block">Premium Mess</span>
                                <h2 className="font-cyber text-4xl text-white glitch-text" data-text="BRAIN FUEL">BRAIN FUEL</h2>
                            </div>
                            
                            {/* Days Selector */}
                            <div className="flex gap-2 overflow-x-auto pb-8 scrollbar-hide justify-start md:justify-center px-2">
                                {Object.keys(MENU).map(d => {
                                    const isActive = d === 'Monday'; // Default to Monday for demo, better to use state
                                    // Let's use internal state for this component
                                    return <MenuButton key={d} day={d} current={'Monday'} onClick={()=>{}} /> // Placeholder, need real state
                                })}
                            </div>
                            <MenuDisplay />
                        </div>
                    </section>

                    {/* ROOMS */}
                    <section className="py-24 px-4 bg-[#080808]">
                        <div className="max-w-7xl mx-auto">
                            <h2 className="font-cyber text-3xl text-center mb-16 text-white">STUDENT SUITES</h2>
                            <div className="grid md:grid-cols-3 gap-8">
                                {[IMG.room1, IMG.room2, IMG.room3].map((src, i) => (
                                    <div key={i} className="h-72 glass-panel rounded-[2rem] overflow-hidden group border border-white/10 relative transform transition hover:-translate-y-2 hover:shadow-[0_10px_40px_rgba(0,243,255,0.15)]">
                                        <img src={src} className="w-full h-full object-cover transition duration-700 group-hover:scale-110 opacity-60 group-hover:opacity-100" />
                                        <div className="absolute inset-0 bg-gradient-to-t from-black via-transparent to-transparent opacity-90"></div>
                                        <div className="absolute bottom-6 left-6">
                                            <div className="bg-blue-600 text-white text-[10px] font-bold px-2 py-1 rounded mb-2 inline-block">TYPE {String.fromCharCode(65+i)}</div>
                                            <h3 className="text-xl font-bold">Standard Bed</h3>
                                            <p className="text-xs text-gray-400">Furnished â€¢ Ventilated</p>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </div>
                    </section>

                    {/* BOOKING */}
                    <section id="booking" className="py-24 px-4 relative overflow-hidden">
                        <div className="max-w-xl mx-auto glass-panel p-8 md:p-12 rounded-[3rem] text-center border border-blue-500/30 shadow-[0_0_80px_rgba(37,99,235,0.15)] relative">
                            <div className="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-blue-500 to-transparent"></div>
                            
                            <div className="bg-red-600/90 text-white text-[10px] font-black px-4 py-1.5 rounded-full inline-flex items-center gap-2 mb-8 animate-pulse shadow-[0_0_15px_rgba(220,38,38,0.5)]">
                                <Flame size={12} className="fill-white" /> LIMITED SEATS LEFT
                            </div>
                            
                            <h2 className="font-cyber text-4xl mb-2 text-white">ELITE PLAN</h2>
                            <p className="text-gray-400 text-sm mb-8">Unlock your full potential.</p>
                            
                            <div className="flex flex-col items-center mb-10 relative">
                                <span className="text-gray-600 text-2xl line-through decoration-red-500 decoration-2 font-mono mb-[-10px]">â‚¹5500</span>
                                <span className="text-7xl md:text-8xl font-cyber text-transparent bg-clip-text bg-gradient-to-b from-white to-gray-400 tracking-tighter" style={{textShadow: '0 0 30px rgba(255,255,255,0.2)'}}>â‚¹4000</span>
                                <span className="text-blue-400 text-xs tracking-[0.3em] font-bold uppercase mt-4 bg-blue-500/10 px-4 py-2 rounded-full border border-blue-500/20">/ Month (All Inclusive)</span>
                            </div>

                            <div className="grid grid-cols-2 gap-y-4 gap-x-8 text-left mb-12 max-w-xs mx-auto">
                                {["3-Time Meals", "24/7 Power", "RO Water", "WiFi Zone", "Study Desk", "CCTV Security"].map(f => (
                                    <div key={f} className="flex items-center gap-3 text-gray-300 text-sm font-bold group">
                                        <CheckCircle size={16} className="text-green-500 group-hover:scale-125 transition" /> {f}
                                    </div>
                                ))}
                            </div>

                            <button onClick={()=>window.location.href="upi://pay?pa=riteshs9122@ybl&pn=SafaltaExpress&am=4000&cu=INR&tn=HostelSeatBooking"} className="w-full bg-gradient-to-r from-blue-600 to-purple-600 py-5 rounded-2xl font-black text-xl hover:scale-105 transition shadow-[0_10px_40px_rgba(37,99,235,0.3)] relative overflow-hidden group">
                                <span className="relative z-10 flex items-center justify-center gap-3">PAY NOW <Sparkles size={20} className="animate-spin" /></span>
                                <div className="absolute inset-0 bg-white/20 translate-y-full group-hover:translate-y-0 transition duration-300"></div>
                            </button>
                            <p className="text-gray-500 text-[10px] mt-6 font-mono">UPI: riteshs9122@ybl</p>
                        </div>
                    </section>

                    {/* FOOTER */}
                    <footer className="py-20 px-4 bg-black border-t border-white/10 text-center">
                        <div className="max-w-4xl mx-auto">
                            <h3 className="font-cyber text-2xl mb-8 text-blue-500">CONTACT BASE</h3>
                            <div className="flex flex-col md:flex-row gap-6 justify-center items-center">
                                <a href="tel:9122802016" className="glass-panel px-8 py-4 rounded-2xl flex items-center gap-4 hover:border-blue-500 transition w-full md:w-auto">
                                    <Phone className="text-green-500" />
                                    <div className="text-left">
                                        <div className="text-xl font-black text-white">9122802016</div>
                                        <span className="text-xs text-gray-500">Main Line</span>
                                    </div>
                                </a>
                                <a href="mailto:riteshs9122@gmail.com" className="glass-panel px-8 py-4 rounded-2xl flex items-center gap-4 hover:border-purple-500 transition w-full md:w-auto">
                                    <Mail className="text-purple-500" />
                                    <div className="text-left">
                                        <div className="text-sm font-bold text-white">riteshs9122@gmail.com</div>
                                        <span className="text-xs text-gray-500">Email Support</span>
                                    </div>
                                </a>
                            </div>
                            <div className="mt-16 text-[10px] font-bold text-gray-700 tracking-[0.5em] uppercase">Safalta Express â€¢ Est 2024</div>
                        </div>
                    </footer>

                    <a href="https://wa.me/919122802016" target="_blank" className="floating-wa">
                        <MessageSquare size={28} fill="white" />
                    </a>
                    
                    <GodModePanel config={config} setConfig={setConfig} applyConfig={()=>{addToast("System Rebooted", "success"); playSound('intro')}} />

                    {/* App Modals */}
                    {activeApp === 'planner' && <OrbitPlanner close={()=>setActiveApp(null)} addXp={addXp} />}
                    {activeApp === 'mistake' && <MistakeVault close={()=>setActiveApp(null)} addXp={addXp} />}
                    
                    {/* Placeholder for other apps */}
                    {(activeApp && activeApp !== 'planner' && activeApp !== 'mistake') && (
                        <div className="fixed inset-0 z-[6000] bg-black/90 backdrop-blur-xl flex items-center justify-center p-4 animate-[fadeIn_0.3s]">
                            <div className="max-w-lg w-full glass-panel p-8 rounded-3xl text-center border border-white/20 relative">
                                <button onClick={()=>setActiveApp(null)} className="absolute top-4 right-4 text-gray-500 hover:text-white"><X/></button>
                                <div className="w-16 h-16 bg-gradient-to-br from-blue-500 to-purple-500 rounded-2xl mx-auto mb-6 flex items-center justify-center shadow-lg">
                                    <Activity size={32} className="text-white" />
                                </div>
                                <h2 className="font-cyber text-2xl text-white mb-2">{activeApp.toUpperCase()}</h2>
                                <p className="text-gray-400 mb-8">This module is currently initializing. Please check back later or contact admin.</p>
                                <button onClick={()=>setActiveApp(null)} className="bg-white/10 hover:bg-white/20 px-6 py-2 rounded-lg font-bold text-sm">Close Module</button>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        // State Wrapper for Menu to avoid large re-renders
        const MenuDisplay = () => {
            const [day, setDay] = useState('Monday');
            const menu = MENU[day];
            
            return (
                <div>
                     <div className="flex gap-2 overflow-x-auto pb-8 scrollbar-hide justify-start md:justify-center px-2 mb-4">
                        {Object.keys(MENU).map(d => (
                            <button 
                                key={d} 
                                onClick={() => setDay(d)} 
                                className={`px-6 py-2 rounded-xl font-black text-xs uppercase whitespace-nowrap transition-all duration-300 ${day === d ? 'bg-yellow-500 text-black shadow-[0_0_20px_rgba(234,179,8,0.5)] scale-110' : 'glass-panel text-gray-400 hover:text-white hover:bg-white/10'}`}
                            >
                                {d}
                            </button>
                        ))}
                    </div>
                    
                    <div className="grid md:grid-cols-3 gap-6 animate-[fadeIn_0.5s]">
                        {[
                            {t:"BREAKFAST", i:menu.b_img, n:menu.b, time:"8:30 AM"}, 
                            {t:"LUNCH", i:menu.l_img, n:menu.l, time:"1:00 PM"}, 
                            {t:"DINNER", i:menu.d_img, n:menu.d, time:"8:30 PM"}
                        ].map((m, idx) => (
                            <div key={idx} className="glass-panel p-5 rounded-3xl border-t-4 border-yellow-500 hover:transform hover:scale-105 transition duration-300">
                                <div className="relative h-48 rounded-2xl overflow-hidden mb-4 group">
                                    <img src={m.i} className="w-full h-full object-cover transition duration-700 group-hover:scale-110" onError={(e)=>{e.target.src=IMG.thali}} />
                                    <div className="absolute inset-0 bg-black/40 group-hover:bg-transparent transition"></div>
                                    <div className="absolute top-2 left-2 bg-black/70 px-3 py-1 rounded-lg text-[10px] font-bold text-yellow-400 backdrop-blur-md border border-yellow-500/30">
                                        {m.t}
                                    </div>
                                </div>
                                <h4 className="text-xl font-bold text-white mb-1">{m.n}</h4>
                                <div className="flex items-center gap-2 text-xs text-gray-500 font-mono">
                                    <div className="w-2 h-2 rounded-full bg-green-500 animate-pulse"></div> Ready at {m.time}
                                </div>
                            </div>
                        ))}
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<MainApp />);
        
        // --- CURSOR LOGIC OUTSIDE REACT FOR PERF ---
        const cursorDot = document.getElementById('cursor-dot');
        const cursorOut = document.getElementById('cursor-outline');
        window.addEventListener('mousemove', (e) => {
            const x = e.clientX; const y = e.clientY;
            cursorDot.style.left = `${x}px`; cursorDot.style.top = `${y}px`;
            cursorOut.animate({ left: `${x}px`, top: `${y}px` }, { duration: 500, fill: "forwards" });
        });
        window.addEventListener('mousedown', () => cursorOut.style.transform = "translate(-50%, -50%) scale(0.8)");
        window.addEventListener('mouseup', () => cursorOut.style.transform = "translate(-50%, -50%) scale(1)");

    </script>
</body>
</html>
